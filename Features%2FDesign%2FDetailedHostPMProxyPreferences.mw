{{autolang|base=yes}}

<!-- The actual name of your feature page should look something like: Features/YourFeatureName.  This keeps all features in the same namespace -->
= Host Power Management Proxy Preferences =

== Summary ==
<!-- A sentence or two summarizing what this feature is and what it will do.  This information is used for the overall feature summary page for each release. -->

== Owner ==
<!--This should link to your home wiki page so we know who you are-->
* Feature owner: [[User:emesika| Eli Mesika]]
:* GUI Component owner: [[User:emesika| Eli Mesika]]
:* REST Component owner: [[User:emesika| Eli Mesika]]
:* Engine Component owner: [[User:emesika| Eli Mesika]]
:* QA Owner: [[User:ykaul| Yaniv Kaul]] 

<!-- Include you email address that you can be reached should people want to contact you about helping with your feature, status is requested, or  technical issues need to be resolved-->
* Email: emesika@redhat.com

== Current status ==
* Target Release: 3.2
* Status: Design
* Last updated date: Nov 4 2012

== Detailed Description ==
<!-- Provide the details of the feature. What is it going to include. See the sections below. -->
<!-- New entities and changes in existing entities. -->


== CRUD ==
Adding a pm_proxy_preferences column to vds_static table.<br>
this column represents a comma separated proxy preferences lists per Host<br>
The default value for this column will be : 'engine,cluster,dc'<br>
So, if this value is for example the default value, a Host that is in non-responsive state and has Power Management configured will be fenced using first the engine then the first UP Host in Cluster then the first UP Host in the Data Center.

=== DAO ===
Adding handling of pm_proxy_preferences to <br>
VdsStaticDAODbFacadeImpl<br>
VdsDAODbFacadeImpl

=== Metadata ===
Adding test for the new pm_proxy_preferences field in VdsStaticDAOTest <br>
Adding test data in fixtures.xml

== Business Logic == 
Add pmProxyPreferences field to VdsStatic<br>
Add pmProxyPreferences field to VDS<br>

FencingExecutor::FindVdsToFence<br>
------------------------------------
Apply the logic of searching for the proxy according to the pmProxyPreferences value<br>



=== Flow ===

== API ==
<!-- describe changes in REST API and SDK -->

== User Experience ==
<!-- Describe user experience related issues. For example: We need a wizard for ...., the behaviour is different in the UI because ....., etc. -->

A new list will be added to the Power Management Tab when adding a new Host or modifying existing Host<br>
The list will have by default the entries : engine,cluster and DC<br>
The user may add other Host IPs or FQDNs by typing a value and pressing the ADD button<br>
The user may also use the UP and DOWN buttons to change items order inside the list<br>

[[File:ProxyPreferences.png]]

== Installation/Upgrade ==
<!-- Describe how the feature will effect new installation or existing one. -->
Add the new pm_proxy_preferences column in the upgrade script.

=== User work-flows ===
<!-- Describe the high-level work-flows relevant to this feature. -->

== Enforcement ==


== Dependencies / Related Features and Projects ==
<!-- What other packages (RPMs) depend on this package?  Are there changes outside the developers' control on which completion of this feature depends?  -->
=== Affected oVirt projects ===


== Documentation / External references ==
<!-- Is there upstream documentation on this feature, or notes you have written yourself?  Link to that material here so other interested developers can get involved. Links to RFEs. -->
[[Features/HostPMProxyPreferences]]

== Open Issues ==
<!-- Issues that we haven't decided how to take care of yet. These are issues that we need to resolve and change this document accordingly. -->

Are defaults applied implicitly?<br>
Meaning, if a user modified the PM Proxy Preferences to be for example only : IP1,IP2 <br>
Does this means that this is the actual chain and if both IP1 & IP2 fails to serve as proxies the Power Management operation fails?<br>
or, we should say that this actually implies IP1,IP2,engine,cluster,dc implicitly?<br>
In case of that, what should we apply if user set PM Proxy Preferences to be engine,IP1,IP2 ?<br>
Suggestion:<br>
engine,cluster,dc should be applied implicitly and missing definitions from the original default (engine,cluster.dc) will be applied using the same priority<br>
Examples:<br>
engine,IP1,IP2 => engine,IP1,IP2,cluster,dc
IP1,dc,IP2     => IP1,dc,IP2,engine,cluster

[[Category: Feature]]
