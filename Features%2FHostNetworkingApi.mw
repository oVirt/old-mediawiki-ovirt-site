= Host Networking API =

== Current Status ==
The current host networking api suffers from various limitations:
* A mix of the physical and the logical network configuration
** Exposing vlan device implementation to the user
** Using 'Sync Network' feature requires to find the specific interface which carries the network
* A Cumbersome request format for 'setup networks':
** creating vlan devices
** a complex input structure to represent the expected configuration
* The attach/detach network isn't the RESTFul way to modify the interface
* Cannot support a host only network (a network without a nic)
** Cannot support a dynamic (external) networks

== Proposed Solution ==
Introducing new sub-collections to reflect the host network configuration:

=== Network connections sub-collection of the nic resource ===
* A collection of network connections that are attached to a specific physical interface or a bond:
  /api/hosts/{host:id}/nics/{nic:id}/networkconnections
* Supported actions:
**# '''GET''' returns a list of networks attached to the nic
**# '''POST''' attaches a network to the nic

==== Network resource ====
  /api/hosts/{host:id}/nics/{nic:id}/networkconnections/{networkconnection:id}
* Supported actions:
**# '''GET''' returns a specific network which is attached to the nic
**# '''DELETE''' detaches a network from the nic

==== Network statistics sub-collection ====
  /api/hosts/{host:id}/nics/{nic:id}/networkconnections/{networkconnections:id}/statistics
* Supported actions:
**# '''GET''' returns a specific statistics for a network (if reported) which is attached to the nic

==== Network connections sub-collection ====
* A collection of network connections which represent how the network is provisioned on the host
  /api/hosts/{host:id}/networkconnections
* Supported actions:
**# '''GET''' returns a list of networks configured on the host
**# '''POST''' provision a network on the host

The '''<networkconnection>''' element describes the how network is configured on the host:
* network - which logical network is connected to the host
* nic - an optional sub-element which described the underlying interface
** When not provided, implies the network is a nic-less network
** Can specify an unused nic or a bond (either existing bond or bond to create requires unused nics).
* external - a flag to indicate whether this network is managed by ovirt/vdsm
* ip - ip address, boot protocol, subnet, gateway
* properties - network custom properties
* qos - the network qos
* sync - sync network on host according to its logical network definition

==== Network connecton resource ====
  /api/hosts/{host:id}/networkconnections/{networkconnection:id}
* Supported actions:
**# '''GET''' returns a specific network configured on the host
**# '''PUT''' update a network configured on the host
**# '''DELETE''' removes a network from the host

==== Network connecton statistics sub-collection ====
  /api/hosts/{host:id}/networkconnections/{networkconnection:id}/statistics
* Supported actions:
**# '''GET''' returns a specific statistics for a network (if reported) which is attached to the host

==== Host Network Label resource ====
A collection designed to specify network labels on host level which aren't bounded to a specific nic.<br>
Using this resource, nic-less networks could be configured on host.
  /api/hosts/{host:id}/networklabels/
* '''GET''' - list host network labels
* '''POST''' - add a label to the host

  /api/hosts/{host:id}/networklabels/{networklabel:id}
* '''GET''' - returns a specific host network label
* '''DELETE''' - removes a specific host network label

'''pros''': Using host level network labels we can support nic-less networks auto-provision<br>
'''cons''': The management of labels becomes more complex, cannot use same label for nics<br>


== Current Host Networking API (up to ovirt-engine-3.5) ==

== What should be deprecated? ==
On /api/hosts/{host:id}/nics/{nic:id}:
<network/> is replaced by /api/hosts/{host:id}/nics/{nic:id}/networkconnections
The vlan devices will be hidden from the list of /api/hosts/{host:id}/nics



Deprecated: /api/hosts/{host:id}/nics/setupnetworks
  <host_nic>
     <network id="..."/>
  </host_nic>

Replaced by: /api/hosts/{host:id}/nics/setupnics
  <host_nic>

  </host_nic>

Request should contain only nics or bonds (no vlans).
