==Summary==
This feature allows the administrator to configure, start, stop and monitor geo-replication for Gluster volumes from oVirt engine. With this the administrator can view the status of geo-replication on Gluster volumes and also would be able to start/stop/configure geo-replication for a volume. GlusterFS geo-replication provides a continuous, asynchronous, and incremental replication service from one site to another over Local Area Networks (LANs), Wide Area Network (WANs), and across the Internet.

To read more about GlusterFS geo-replication, see http://gluster.org/community/documentation/index.php/Gluster_3.2:_GlusterFS_Geo-replication_Deployment_Overview.

==Owner==
*Feature owner: Shubhendu Tripathi <shtripat@redhat.com>
**GUI Component owner: Kanagaraj Mayilsamy <kmayilsa@redhat.com>
**Engine Component owner: Shubhendu Tripathi <shtripat@redhat.com>
**VDSM Component owner: Balamurugan Arumugam <barumuga@redhat.com>
**QA Owner: Sudhir Dharanendraiah <sdharane@redhat.com>

== Current Status ==

* Status: In Progress
* Last updated date: Thu Jan 17 2013

== Detailed Description ==
GlusterFS Geo-replication uses a master–slave model, whereby replication and mirroring occurs between the following partners:
*Master – A GlusterFS volume
*Slave – A GlusterFS Volume in a remote cluster

With this feature the user will be able to
* View all the slaves attached to a cluster
* Add a new slave and enable password less communication between a host of master cluster and a host of slave cluster
* Test password less communication to slave cluster/host
*  Remove(Detach) a slave cluster
* View all active/inactive geo-replication sessions for a volume
* Setup a new ge-replication session
* Start a geo-replication session
* Stop a geo-replication session
* Remove an inactive geo-replication session
* View and update the configuration before starting the session or later (ssh command, gsync command)
* Monitor the status of geo-replication sessions in a cluster

== Design ==
Geo-replication feature is designed to enable creation and maintenance of geo-replication sessions across clusters in GlusterFS. A geo-replication session can be setup between a GlusterFS managed master cluster and remote (slave) GlusterFS managed cluster.

=== Entity Description ===

==== Geo Replication Slave ====
This entity stores the details of remote (slave) for a geo-replication setup.
* Master Cluster Id
* Master Host Id
* Slave Host IP
* Slave SSH Key Fingerprint

==== Gluster Geo Replication ====
This entity stores the details of the individual geo-replication sessions
* Master Cluster Id
* Master Host Id
* Slave Host IP
* Master Volume Name
* Slave Volume Name

==== Gluster Geo Replication Status ====
This entity stores the status of individual geo-replication sessions maintained in oVirt engine
* Master Cluster Id
* Master Host Id
* Master Volume Name
* Slave Host IP
* Slave Volume Name
* Status - Valid values from GlusterGeoRepStatus
** STABLE
** FAULTY
** INITIALIZING
** NOT_STARTED

==== Geo Replication Config ====
This entity stores the configuration details of a geo-replication session
* Config Name
* Config Value

Configuration details would be maintained under a generic configuration maintenance system. Details captured as part of the same are -
* Configuration Category - Broadly divides the configuration in categories like Gluster Geo-Replication, Gluster Volume Options etc.
* Configuration Sub Category - Next level of logical grouping of configurations e.g. generic, logging, session etc in case of Configuration category as Gluster Geo-Replication
* Configuration Name - Name of the configuration
* Configuration Value - Value of the configuration

Valid configuration categories would be maintained as an enum GlusterConfigurationTypes.
Valid configuration sub categories would be maintained as an enum GlusterConfigurationSubTypes. This enum maintains enclosing main configuration category as a parameter.

=== User Experience ===
==== Add/Attach a new Slave Cluster ====
Password less SSH communication should be enabled between one node of the master cluster and one node of slave cluster before creating a geo-replication session between the identified master and slave clusters.

[[File:geo_replication_slave1_new.png]]

==== Create a  new Geo-Replication Session ====

==== View All Geo-Replication Sessions ====
A new sub tab will be added to the Volumes main tab in oVirt webadmin UI which will list all the geo-replication sessions for the selected volume.

==== Start a new Geo-Replication Session ====
A new action named '''Start''' will be shown in the '''Geo-Replication''' tab. On clicking of the action will open the following dialog.

[[File:Geo-Replication-Start.png]]

* '''Start Geo-Replication from Host''' field will list all the servers in the cluster which are in '''UP''' state. When the user selects one of the host, SSH Fingerprint of the host will be fetched and shown.
* '''Remote Host''' could be either a standalone machine or part of another cluster. 
* '''Remote Volume/Path''' will accept either name of a volume in a remote cluster or a directory in the remote host. If it doesn't starts with '''/''', it will be considered as a volume in the remote cluster. 
* After providing all the details and when the user clicks '''Ok''',
** Password less SSH communication between the origin host  and '''Remote Host''' will be verified.
** If that succeeded, the geo-replication session for the selected volume started
** Else the [[:File:Geo-Replication-Start-SSH-Setup[.png|Passwordless SSH Setup]] dialog will be shown.
* If the user wants to override the default configuration, he/she can deselect '''Use Default''' checkbox and provide different configuration. In this case no password less SSH verification will be made. 

==== Stop a Geo-Replication Session ====

==== Remove a Geo-Replication Session ====

==== Configurations of Geo-Replication Session ====

== Dependencies / Related Features and Projects ==

== Test Cases ==

== Documentation / External references ==

http://www.gluster.org/community/documentation/index.php/GlusterFS_Geo_Replication

http://gluster.org/community/documentation/index.php/Gluster_3.2:_Starting_GlusterFS_Geo-replication

== Comments and Discussion ==
http://www.ovirt.org/Talk:Features/Gluster_Geo_Replication

== Open Issues ==

[[Category:Feature]]
