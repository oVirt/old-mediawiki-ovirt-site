<!-- {{autolang|base=yes}} -->

<!-- The actual name of your feature page should look something like: "Your feature name". Use natural language to name the pages. -->
== Network Wiring ==

=== Summary ===
<!-- A sentence or two summarizing what this feature is and what it will do.  This information is used for the overall feature summary page for each release. -->
The network wiring feature is an enhancement for the VM Network Interface management.
It supports the following actions without unplugging the Vnic, maintaining the address of the Vnic:
:* Dynamically changing the network of a running VM. <br>
:* Unwiring a network of a VM. <br>

=== Owner ===
* Name: [[User:alkaplan| Alona Kaplan]]
* Email: <alkaplan@redhat.com>

=== Current status ===
[http://ovirt.org/wiki/Feature/DetailedNetworkWiring Network Wiring Detailed Design]
* Last update date: 04/11/2012

=== Introduction ===
Currently oVirt engine supports configuring the VM Network Interface either on creation or updating it when the VM is down.<BR>
:* oVirt-engine already supports hot-plug and hot-unplug of vnics, however it lacks the capability of performing changes of the Vnic once the Vnic is plugged and to preserve the Vnic's PCI address.<BR>

==== High Level Feature Description ====
A Vnic on a running VM can have 4 states (If the VM is down, its state represents how it should behave once started)
* '''Plugged'''
:* '''Wired''' - The Vnic is defined on the VM and connected to the Network.
::* Observed as the vnic is located on its slot and a network cable is connected to it.
::* This is the only state on which the state of the VM Network Interface is 'Active'.
:* '''Unwired''' - The Vnic is defined on the VM and isn't connected to any network.
::* Observed as the vnic is located on its slot but no network cable is connected to it.
* '''Unplugged''' - at this state the Vnic is defined on oVirt-engine only
:* '''Wired''' - once the Vnic is plugged it will automatically be connected to the Network and become 'Active'. 
:* '''Unwired''' - once the Vnic is plugged it won't be connected to any network.

The oVirt-engine's user will be able to configure the Vnic state to any of the mentioned above by any of the following methods:
* API
* Admin portal
* User portal

==== User Experience ====

==== Admin/User Portal ==== 
===== Virtual Machines -> Network Interfaces sub tab =====
* '''New Columns'''
:* "Plugged"- will be added after "Name" column.
:* "Wired"- will be added after "Network Name" column.
* '''Updated Columns'''
:* "Status" (icon)- green icon if plugged and wired, red icon- otherwise. The tooltip will display a text of both the "plugged" and "wired" status.
* '''Removed Actions'''
:* Activate/Deactivate
::* Menu
:::* These actions will be removed from the action menu of the subtab and from the context menu (The user will be able to plug/unplug the Vnic's through the add/edit Vnic dialogs)
* '''Updated Actions'''
:* Add
::* Dialog
:::* Adding radio button with two options "Wired/"Unwired" under the "network" combo.
:::* "Activate" checkbox will be changed to a radio button with two options "Plugged"/"Unplugged".

:* Edit
::* Menu
:::* If the VM status is up, the edit action should be enabled (previously it was disabled).
::* Dialog
:::* If the VM status is up
::::* If the Vnic is plugged there should be a message on top of the dialog "Please notice, changing <b>Type</b> or <b>MAC</b> will cause unplugging and plugging the Vnic".
::::* Port Mirroring- If the Vnic is plugged and there is port mirroring on the Vnic- "network", "type", "mac" and "port mirroring" fields in the dialog will be disabled.
:::: Stretched Goal- enable dynamic changes when there is port mirroring (without plugging and unplugging).
:::* Adding radio button with two options "Wired/"Unwired" under the "network" combo.
:::* Adding radio button with two options "Plugged"/"Unplugged" to the end of the dialog..

[[File:vnicWiring.png|400px]]

==== REST API ====
NIC properties:

Changes:
* Adding new properties under VM NIC:
:* plugged
:* wired
* Deprecating the active property under VM NIC
* Deprecating activate/deactivate actions
* Plug/unplug and wire/unwire on a vnic, will be done via PUT action on the VM NIC 
** /api/vms/xxx/nics/yyy/
There is no reason to have dedicated actions for plug/unplug or wire/unwire.
The original reason for having them was that edit VM nic while the VM was up used to be blocked and now we'll enable doing these actions.

=== Benefit to oVirt ===
The feature is an enhancement of the oVirt-engine Vnic management:
* Dynamically updating the Vnic configuration by the admin or by the user.

=== Dependencies / Related Features ===
The Network Permissions is dependent on the following features:
* [http://wiki.ovirt.org/wiki/Feature/NetworkPermissions Permission on Networks]

Affected oVirt projects:
* oVirt-engine
** API
** Admin Portal
** User Portal
* VDSM

=== Documentation / External references ===
Bugzilla - https://bugzilla.redhat.com/show_bug.cgi?id=873244

=== Comments and Discussion ===

[[Category:Feature]]
[[Category:Template]]
