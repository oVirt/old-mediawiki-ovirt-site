<!-- {{autolang|base=yes}} -->

<!-- The actual name of your feature page should look something like: "Your feature name". Use natural language to name the pages. -->

<!-- The actual name of your feature page should look something like: "Your feature name". Use natural language to [[How to make pages#Page naming|name the pages]].-->

== Engine Cleanup (Work in progress) <!-- The name of your feature --> ==

=== Summary ===
<!-- A sentence or two summarizing what this feature is and what it will do.  This information is used for the overall feature summary page for each release. -->
This utility is intended to bring the host to a state it can be reused by oVirt engine 

=== Owner ===
<!--This should link to your home wiki page so we know who you are-->
This should link to your home wiki page so we know who you are

* Name: [[User:MyUser| TBD]]

<!-- Include you email address that you can be reached should people want to contact you about helping with your feature, status is requested, or  technical issues need to be resolved-->
Include you email address that you can be reached should people want to contact you about helping with your feature, status is requested, or  technical issues need to be resolved
* Email: TBD


=== Current status ===
(To be replaced to a link when a desing page will be created)

 * Drop DB - works both on local and remote
 * Remove keystore (not perfect)
 * cleanup symlinks
 * stop services (jbossas, notifer)

Missing to comply with the purpose definition:
----------------------------------------------
 * Default mode is interactive - asking if to drop DB or not.
   Message: Drop data base? if you want to reuse the existing database for the future installation choose no.
 * Message at the end: Finished cleanup please run 'yum remove ....' and then reinstall
 * If it did not dropped DB add: Note that after reinstall you'll have to run Hosts re-install/re-approve
 * Add a non-interactive switch -b, default is drop DB.
 * Add another switch: --preserve-db


=== Detailed Description ===
<!-- Expand on the summary, if appropriate.  A couple sentences suffices to explain the goal, but the more details you can provide the better. -->
The cleanup should provide
1. Reset a failed installation to a state in which you can safely run yum remove and then yum install engine
   Meaning the sequence: engine-cleanup, yum remove ovirt-engine, yum install ovirt-engine, engine-setup
   Stretch goal - avoid the remove/install part if planing to re-install the same version
2. Cleanup before a new installation after the user has run yum remove and now tries it all over.
   Meaning the sequence: yum remove ovirt-engine, yum install ovirt-engine, engine-cleanup ,engine-setup
3. Reset an exiting installation without dropping DB. Use cases, fix failed upgrade or a corrupted installation
   Next 'Manual' steps: yum remove engine
                        yum install engine
                        engine-setup should know how to reuse this DB (upgrade if necessary)
 
Note 1: This utility is not intended to leave the hosts clean for other application to reuse - only to be reused by a freoVirt Manager
Note 2: Preserve DB is not intended to relocate db from local to remote and vice verse - Need to provide a procedure to do that.
Note 3: It will not remove any export, including the one it created during last installation. If we wish for engine-setup to reuse this is enhancement to for engine-setup.



=== Benefit to oVirt ===
<!-- What is the benefit to the oVirt project?  If this is a major capability update, what has changed?  If this is a new feature, what capabilities does it bring? Why will oVirt become a better distribution or project because of this feature?-->
What is the benefit to the oVirt project?  If this is a major capability update, what has changed?  If this is a new feature, what capabilities does it bring? Why will oVirt become a better distribution or project because of this feature?


=== Dependencies / Related Features ===
<!-- What other packages depend on this package?  Are there changes outside the developers' control on which completion of this feature depends?  In other words, completion of another feature owned by someone else and might cause you to not be able to finish on time or that you would need to coordinate? Other Features that might get affected by this feature? -->




=== Documentation / External references ===
<!-- Is there upstream documentation on this feature, or notes you have written yourself?  Link to that material here so other interested developers can get involved. Links to RFEs. -->
Is there upstream documentation on this feature, or notes you have written yourself?  Link to that material here so other interested developers can get involved. Links to RFEs.


=== Comments and Discussion ===

This below adds a link to the "discussion" tab associated with your page.  This provides the ability to have ongoing comments or conversation without bogging down the main feature page

* Refer to [[Talk:Your feature name]]  <!-- This adds a link to the "discussion" tab associated with your page.  This provides the ability to have ongoing comments or conversation without bogging down the main feature page -->

[[Category:Feature]]
[[Category:Template]]
