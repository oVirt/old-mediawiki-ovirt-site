<!-- {{autolang|base=yes}} -->

== Host's Bios Information ==

=== Summary ===
When assigning new host to oVirt engine  the engine retrieves general information about the host. This information includes Vdsm version, CPU units and inc. This article describes the bios information that the host provides to oVirt engine.

=== Owner ===
* Name: [[User:ybronhei| Yaniv Bronhaim]]

* Email: ybronhei@redhat.com

=== Current status ===
* Target Release: 3.2
* Status: Work In Progress
* Last updated date: Nov 20 2012

=== Detailed Description ===
The following feature allows the user interface to present host's bios information when adding new hypervisor. <BR>
This information is taken by using dmidecode command, this command runs with root permissions over the host and returns the information with getCapabilities API method. This adds the following data[1]: <BR>
 1. Host Manufacturer - Manufacturer of the host's machine and bios' vendor (e.g LENOVO)
 2. Host Version - For each host the manufacturer gives a unique name (e.g. Lenovo T420s)
 3. Host Product Name - ID of the product - same for all similar products (e.g 4174BH4)
 4. Host UUID - Unique ID for each host (e.g E03DD601-5219-11CB-BB3F-892313086897)
 5. Host Family - Type of host's CPU - (e.g Core i5)
 6. Host Serial Number - Unique ID for host's chassis (e.g R9M4N4G)
[1] More parameters can be added on request.

==== User Experience ====
<!-- Describe user experience related issues. For example: We need a wizard for ...., the behaviour is different in the UI because ....., etc. -->
Under Hosts tab we have general information about the chosen host. In this tab you see general information that was retrieved from the host:
<BR>
[[File:General-tab.jpeg]]
<BR><BR>
This feature adds new host's sub-tab called Hardware-Information and modifies general tab to Software-Information. Hardware-Information will display the following fields:<BR>
[[File:Bios.jpeg]]

==== VDSM Flow ====
Each time Vdsm receives getCapabilities request Vdsm retrieves the bios information by using python-dmidecode utility. After collecting and arranging the information, Vdsm delivers it to engine by xml rpc.

==== Engine Flow ====
When gathering host's capabilities we receive host's bios details by VDSM API ( Although, Bios information stays constant, vdsm retrieves this information in each request without holding cache of this data  ) This information is written to the database to vds_dynamic table (as refer to the new update table 03_01_1530_add_vds_bios_info.sql).<BR>
The values of those parameters gets updated every time the host returns capabilities response. <BR>
This information is mapped to Vds entity and kept there, when mapping to UI we use those parameters to build the Host entity. Because host capabilities are filled with dynamic data, also here we keep the dynamic flow. <BR>
Engine sends getCapabilities request on start-up,  on activate host and when host is non-responsive every 2 seconds.<BR>

==== REST API ====
The host's bios parameters is shown via engine rest API under host object as the following:<BR>
 <bios_information>
  <manufacturer>Dell Inc.</manufacturer>
  <version>01</version>
  <serial_number>H2CQ95J</serial_number>
  <product_name>OptiPlex 790</product_name>
  <uuid>4C4C4544-0032-4310-8051-C8C04F39354A</uuid>
  <family>Core i7</family>
 </bios_information>

==== Vdsm And Engine API ====
Same as get host capabilities api: getCapabilites returns the same structure with bios information included as part of its record.

=== Open Issues ===
 1. Dmidecode retrieves more parameters that can be helpful for us, below is all the parameters list. 
<BR>
 2. Caching: VDSM calls to dmidecode in each request, should we keep cache of this information? (depends on the information we retrieve, if the data can be changed or not)<BR>
 We should not run dmidecode command in each getCapabilities call.
<BR>
 3. Refresh: getCapabilities command can be manually initiated, do we want this method?<BR>
 This request is not related to the current feature and we decided to split them.
<BR>
 4. Where in the UI this information will be displayed? Host's general tab is full:<BR>
 Bios information will be displayed in a new Host's sub-tab which will be called Hardware Information tab. General tab will be renamed to Software Information.
<BR>

=== dmidecode Output ===
==== System Information ====
dmi_type - 1<BR>
SKU Number - Not Specified<BR>
UUID - E03DD601-5219-11CB-BB3F-892313086897<BR>
Family - ThinkPad T420s<BR>
Serial Number - R9M4N4G<BR>
Version - ThinkPad T420s<BR>
Wake-Up Type - Power Switch<BR>
Product Name - 4174BH4<BR>
dmi_handle - 0x0010<BR>
dmi_size - 27<BR>
Manufacturer - LENOVO<BR>

==== Bios Information ====
NEC PC-98 - False<BR>
EDD is supported - True<BR>
PC Card (PCMCIA) is supported - False<BR>
I2O boot - False<BR>
3.5"/2.88 MB floppy services are supported (int 13h) - False<BR>
BIOS Revision - 1.31<BR>
ATAPI Zip drive boot - False<BR>
Version - 8CET51WW (1.31 )<BR>
BIOS is upgradeable - True<BR>
Smart battery - False<BR>
8042 keyboard services are supported (int 9h) - True<BR>
BIOS shadowing is allowed - True<BR>
BIOS ROM is socketed - False<BR>
USB legacy - True<BR>
APM is supported - False<BR>
AGP - False<BR>
PNP is supported - True<BR>
VLB is supported - False<BR>
Vendor - LENOVO<BR>
ISA is supported - False<BR>
Japanese floppy for Toshiba 1.2 MB is supported (int 13h) - False<BR>
CGA/mono video services are supported (int 10h) - True<BR>
Serial services are supported (int 14h) - True<BR>
5.25"/360 KB floppy services are supported (int 13h) - False<BR>
Address - 0xe0000<BR>
ROM Size - 8192 KB<BR>
Function key-initiated network boot - True<BR>
Currently Installed Language - ['en-US']<BR>
Runtime Size - 128 KB<BR>
Targeted content distribution - False<BR>
3.5"/720 KB floppy services are supported (int 13h) - True<BR>
Relase Date - 11/29/2011<BR>
BIOS boot specification - True<BR>
MCA is supported - False<BR>
PCI is supported - True<BR>
5.25"/1.2 MB floppy services are supported (int 13h) - False<BR>
dmi_handle - 0x002d<BR>
Selectable boot is supported - True<BR>
dmi_type - 13<BR>
Japanese floppy for NEC 9800 1.2 MB is supported (int 13h) - False<BR>
EISA is supported - False<BR>
Print screen service is supported (int 5h) - True<BR>
Boot from PC Card (PCMCIA) is supported - False<BR>
Printer services are supported (int 17h) - True<BR>
ESCD support is available - False<BR>
dmi_size - 22<BR>
Boot from CD is supported - True<BR>
Installed Languages - 1<BR>
ACPI - True<BR>
LS-120 boot - False<BR>
IEEE 1394 boot - False<BR>

==== Cache Information ====
dmi_type - 7<BR>
System Type - Data<BR>
Socket Designation - L2-Cache<BR>
Installed SRAM Type - [None, None, None, None, None, 'Synchronous', None]<BR>
Level - 2<BR>
Socketed - False<BR>
Associativity - 8-way Set-associative<BR>
Supported SRAM Type - [None, None, None, None, None, 'Synchronous', None]<BR>
Enabled - True<BR>
Maximum Size - 256 KB<BR>
dmi_handle - 0x0003v
Installed Size - 256 KB<BR>
Location - Internal<BR>
Error Correction Type - Single-bit ECC<BR>
Speed - Unknown<BR>
Operational Mode - Write Through<BR>
dmi_size - 19<BR>

==== Processor Information ====
Upgrade - ZIF Socket<BR>
Socket Designation - CPU<BR>
L2 Cache Handle - 0x0003<BR>
Version - Intel(R) Core(TM) i5-2540M CPU @ 2.60GHz<BR>
Type - Central Processor<BR>
Core Count - 2<BR>
Status - Populated:Enabled<BR>
Vendor - Intel(R) Corporation<BR>
Core Enabled - 2<BR>
dmi_handle - 0x0001<BR>
External Clock - 100<BR>
Serial Number - Not Supported by CPU<BR>
Current Speed - 2600<BR>
dmi_size - 42<BR>
L3 Cache Handle - 0x0004<BR>
Part Number - None<BR>
Asset Tag - None<BR>
Signature - None<BR>
L1 Cache Handle - 0x0002<BR>
ID - a7 06 02 00 ff fb eb bf<BR>
dmi_type - 4<BR>
Family - <BR>
Characteristics - ['64-bit capable']<BR>
Voltage - 1.2 V<BR>
Max Speed - 2600<BR>
Thread Count - 4<BR>

==== Chassis Information ==== 
dmi_type - 3<BR>
Type - Notebook<BR>
Power Supply State - Unknown<BR>
Thermal State - Unknown<BR>
Asset Tag - RH0003183<BR>
Serial Number - R9M4N4G<BR>
Version - Not Available<BR>
Lock - Not Present<BR>
Security Status - Unknown<BR>
Boot-Up State - Unknown<BR>
dmi_handle - 0x0012<BR>
dmi_size - 21<BR>
Manufacturer - LENOVO<BR>

==== Memory Information ====
Use - System Memory<BR>
Location - System Board Or Motherboard<BR>
Type - <BR>
Array Handle - 0x0005<BR>
Number Of Devices - 2<BR>
Serial Number - 340F5D7F<BR>
Total Width - 64 bit<BR>
Form Factor - SODIMM<BR>
dmi_size - 15<BR>
Manufacturer - Kingston<BR>
Data Width - 64 bit<BR>
Part Number - 99U5428-046.A00LF<BR>
AssetTag - 9876543210<BR>
Bank Locator - BANK 2<BR>
Error Correction Type - None<BR>
dmi_handle - 0x0005<BR>
dmi_type - 16<BR>
Maximum Capacity - 16 GB<BR>
Set - None<BR>
Error Information Handle - Not Provided<BR>
Locator - ChannelB-DIMM0<BR>
Type Detail - [None, None, None, None, None, None, 'Synchronous', None, None, None, None, None]<BR>
Speed - 1333 MHz (0.8ns)<BR>
Size - 4096 MB<BR>

[[Category:Feature]]
