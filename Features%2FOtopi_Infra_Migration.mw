<!-- {{autolang|base=yes}} -->

== Otopi Infra Migration ==

=== Summary ===
A complete re-write of engine-setup, engine-cleanup, engine-upgrade and AIO plugin using otopi.

=== Owner ===
* Name: [[User:Alonbl|Alon Bar-Lev]]
* Email: <alonbl@redhat.com>

* Name: [[User:Alourie| Alex Lourie]]
* Email: <alourie@redhat.com>

* Name: [[User:SandroBonazzola| Sandro Bonazzola]]
* Email: <sbonazzo@redhat.com>

=== Current status ===

* Last updated: {{CURRENTMONTHNAME}} {{CURRENTDAY}}, {{CURRENTYEAR}}<!--This is markup for current date, do not change-->


{| class="wikitable" border="1"
|-
! Feature
! Existing implementation
! Otopi implementation
! Owner
|-
| Set Max Shared Memory
| Done
| Done
|
|-
| Check for supported Java VM
| Done
| Done
|
|-
| CA Generation
| Done
| Done
|
|-
| Extract CA fingerprint
| Done
| Done
|
|-
| Extract non password key for log collector
| Done
| Done
|-
| Extract non password key for Apache
| Done
| Done
|
|-
| Extract SSH fingerprint
| Done
| Done
|
|-
| Configure engine service - database
| Done
| Done
|
|-
| Configure engine service - Java
| Done
| Done
|
|-
| Configure engine service - Protocols
| Done
| Done
|
|-
| Configure .pgpass file
| Done
| Done
|
|-
| Encrypt DB Password
| Done
| Done
|
|-
| Push the encrypted password into the local configuration file
| Done
| Done
|
|-
| Start / Stop rhevm-etl service when needed
| Done
| Not implemented
|
|-
| Start / Stop rhevm-notifierd service when needed
| Done
| Not implemented
|
|-
| Upgrade engine database if already exist
| Done
| Done
|
|-
| Install engine database if doesn't exist
| Done
| Done
|
|-
| Set Application Mode (Both, Virt, Gluster)
| Done
| Done
|
|-
| Update VDC Options
| Done
| Done
|
|-
| Update default data center storage type
| Done
| Not implemented
|
|-
| Configure engine-log-collector
| Done
| Not implemented
|
|-
| Configure engine-iso-uploader
| Done
| Not implemented
|
|-
| Configure engine-image-uploader
| Done
| Not implemented
|
|-
| Configure PostgreSQL max_connections if using local DB
| Done
| Not implemented
|
|-
| Configure NFS exports for ISO Domain if requested
| Done
| Not implemented
|
|-
| Allow importing existing NFS ISO Domain
| Done
| Not implemented
|
|-
| Create new NFS ISO Domain
| Done
| Not implemented
|
|-
| Migrate existing NFS ISO exports from /etc/exports to /etc/exports.d/
| Done
| Not implemented
|
|-
| Set selinux context for NFS ISO mount points
| Done
| Not implemented
|
|-
| set NFS/portmap ports by overriding /etc/sysconfig/nfs
| Done
| Not implemented
|
|-
| Enable the rpcbind and nfs services
| Done
| Not implemented
|
|-
| Load files (iso,vfd) from existing rpms to ISO domain
| Done
| Not implemented
|
|-
| Configure and enable iptables if requested
| Done
| Not implemented
|
|-
| Configure and enable FirewallD if requested
| Done
| Not implemented
|
|-
| Start / Stop Engine service when needed
| Done
| Done
|
|-
| Enable httpd_can_network_connect selinux flag
| Done
| Not implemented
|
|-
| Backup old Apache httpd config when needed
| Done
| Not implemented
|
|-
| Configure Apache mod_ssl for using  engine apache keys
| Done
| Not implemented
|
|-
| Configure Apache for listening on requested HTTP port
| Done
| Not implemented
|
|-
| Configure Apache for listening on requested HTTPS port
| Done
| Not implemented
|
|-
| Configure Apache as proxy for the requests to the jboss service
| Done
| Not implemented
|
|-
| Enable the httpd service
| Done
| Not implemented
|
|}

=== Detailed Description ===
TBD


=== Benefit to oVirt ===
* Lower cost of maintenance. 
* Use of otopi API.
* More ...


=== Dependencies / Related Features ===
<!-- What other packages depend on this package?  Are there changes outside the developers' control on which completion of this feature depends?  In other words, completion of another feature owned by someone else and might cause you to not be able to finish on time or that you would need to coordinate? Other Features that might get affected by this feature? -->
TBD

=== Documentation / External references ===
* [[:File:ovirt-host-deploy 3.2.pdf|Ovirt Host Deploy Presentation]]
* [https://bugzilla.redhat.com/show_bug.cgi?id=911191 Bug 911191 - Migrate ovirt-engine-setup and AIO plugin to otopi]

=== Comments and Discussion ===
* Refer to [[Talk:Features/Otopi_Infra_Migration]] 

[[Category:Feature]]
[[Category:Template]]
