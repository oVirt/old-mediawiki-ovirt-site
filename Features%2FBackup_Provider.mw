== Backup Provider ==

=== Summary ===
Add support of an ovirt system backup and restore using persisted ovf files.

=== Owner ===
* Name: [[User:vvolansk|Vered Volansky]]
* Email: vered@redhat.com

=== Current status ===
* Design
* Last updated: {{CURRENTMONTHNAME}} {{CURRENTDAY}}, {{CURRENTYEAR}}<!--This is markup for current date, do not change-->

=== Detailed Description ===
The situation prior to this feature addition is the following:<br/>
There's code collecting data into an ovf in the Master Storage Domain (MSD from here on).
That's it. No other code is implemented for reading it (restore).<br/>
This feature's intention is first to rearrange the code taking care of generating the ovf files as a Provider - Backup Provider.<br/>
This feature will also add other persisting methods other than MSD, enabling different types of the Backup Provider.
The Settings for each Backup Provider will vary according to what the specific type requires.<br/>
One system may be configured with several Backup Providers.<br/>
Finally we will add the restore functionality, which is currently missing from the code altogether.
====Phase 1====
Extract the current code into a Backup Provider.<br/>
The backup will be on the system level, applied to all DCs in the system as default, with the option apply for only one DC.
The code extraction will result in one specific Backup Provider of type MSD.

====Phase 2====
* Persist the ovf to the following different locations (in addition to MSD):
** Local FS - We may want to persist the ovfs to a DB. Other than the relative simplicity of using SQL rather than FS hierarchy for the ovf files, another motivation for this metod is the fact that we need to display all VMs to the user when restoring (The user  may want to pick which VMs he wants to restore). For this, we need VM identities, specifically names. Since Guids aren't enough it might be simplest to use a DB to hold the some more data on the ovf.
** Swift (?)
** Debug (?) - We may want to create a Debug Provider for debug purposes only, not exposed to the end user.
** NoOp - No use of Backup will be supported. If Backup is indeed used, it should be chroned every x minutes. It may be easier to run it anyway, just as a default NoOp Backup Provider should no other provider is specifically configured. Still to be decided whether to chrone the job with NoOp or not chrone it at all if no Backup Provider is assigned to the system. 
* Restore the system. The user will be able to pick which VMs he wants to restore, and how many of each of them, resembling import. To be discussed - restore flow in case there are multiple Backup Providers configured for the system.
* Attach existing Backup Provider.  For example, should a user stop backup and then want to re-attach it. The user should also be able to add an existing Backup Provider (with data) to a new system. In this case the user should be prompted whether to pick up from latest backup or start from scratch.

=== Benefit to oVirt ===
This feature will allow actual Backing up and Restoring oVirt systems. Current Backup doesn't actually backup the system, mainly since there's no restore.
Other than the obvious most needed restore, this feature will arrange the Backup into a Provider,  allowing the user to set and use it easily.
Adding the varied Provider types will add diversity to the system. Specifically adding the called-for local FS Backup Provider.
The Benefit to oVirt users will be an easy-to-use backup-restore capabilities, at system level.

=== Dependencies / Related Features ===
<!-- What other packages depend on this package?  Are there changes outside the developers' control on which completion of this feature depends?  In other words, completion of another feature owned by someone else and might cause you to not be able to finish on time or that you would need to coordinate? Other Features that might get affected by this feature? -->

=== Documentation / External references ===
<!-- Is there upstream documentation on this feature, or notes you have written yourself?  Link to that material here so other interested developers can get involved. Links to RFEs. -->

=== Testing ===
The main idea will be to make sure the ovfs were all persisted to the required location according to the type and that later on the system can be restored as a whole, as well as partial systems (when the user picks certain Vms, and not the whole system).<br/>
Tests should be done on each Backup Provider separately, followed by backup and restore tests on a system with several Backup Providers.


=== Comments and Discussion ===
* Refer to [[Talk:Backup_Provider]] 

[[Category:Feature]]
