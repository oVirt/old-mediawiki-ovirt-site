== VM device PCI passthrough ==

=== Summary ===
This feature will allow VDSM to assign pci device to guest using passthrough

=== Owner ===
* Name: [[User:Martin Polednik| Martin Polednik]]
* Email: [mailto:mpoledni@redhat.com mpoledni@redhat.com]

=== Current status ===
* Last updated date: Mon Nov 06 2013

- waiting for refactored device handling in VDSM

=== VDSM side ===
Unlike virtual devices, PCI passthrough uses real host hardware, making the number of such assigned devices limited.
VDSM has to internally keep list (dict) of PCI devices and their assignments and report this data to engine. As these devices
are persisted in libvirt XML, we don't need to persist the list itself but reconstruct it using getUnderlying* function. VMs that
are assigned devices that do not exist anymore will refuse to boot, reporting libvirterror message to engine. 

==== Migration ====
Migration is complicated by the fact that migrating VM with assigned PCI device will cause such device to be hot-unplugged
and hot-plugged after the migration is done, causing possible downtime in service. Therefore, migration will not be allowed
for devices with specific hardware assigned to them (such as GPU).

* '''Devices with possible migration:'''
** VMs with physical NIC can be migrated without downtime of service using bonding [http://net.pku.edu.cn/vc/read/VM_OLS08.pdf].

* '''Devices where migration is not easily possible:'''
** GPU, TPM (passthrough), ... (probably more)

=== Engine side ===
* Finding a suitable host in cluster based on required devices for starting a VM
* Migration should be force-disabled for VM's with devices without migration support
[[Category:Feature]]
