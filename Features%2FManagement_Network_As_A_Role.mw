{{Feature|name=Management network as a role|modules=Networking|version=oVirt 3.6|status=design|}}
<!-- {{autolang|base=yes}} -->

= Summary =
This feature is about attaching the management network role to an arbitrary network in a cluster.

= Detailed Description =

== Motivation ==
Allow assigning different VLANs to management networks in different clusters under same data center.

== Entity Description ==
* No new entities
* ''Management'' boolean field will be added to NetworkCluster entity. ''True'' value will indicate that the network is the management one in the given cluster (similarly like it been done for display networks).

== User Experience ==
=== UI ===
# The existing "Manage network(s)" screens will be updated with the new column "Management Network".  User will be able to change the management network assignement through the screens in the similar way like it's currently done for display network.
# The default management network name will be changed from "ovirmgmt" to "Management".  That will be used for creating the first default network in a new created data center (the existing 'ovirtmgmt' networks will remain AS IS).
# The new parameter (management network) will be added in "New cluster" screen. 
===RESTful API ===
# As mentioned before NetworkCluster entity will be extended by the new field. That will be reflected through the RESTful API.
# The new optional parameter (management network) will be added for creating a new cluster API call.

==  User work-flows  ==
Here are work flows that will be affected by implementing the feature:
* Appointing a network as the management network will make the network required in the given cluster.
* Changing the management network in a cluster (through one of the options metioned earlier). Possible scenarios are:
** Issuing "setup networks" command for every host in the cluster.
** Report the hosts as out-of-sync. This approach requires a Vdsm-side change - it would need to report which of its network is the default route.
* Moving a host from a cluster to another one. 
** As soon as the mangement network is a required one, the flow will be covered by the current behavior - in case the necluster management network isn't defined on the host, it'll become "Non-operational", otherwise it'll remain in the same status it was.
** '''Note''': in case that the new management network is defined on the host, but the engine could not access the NIC it defined on, the host will become "Non-responsive" (covered by the current behavior).
* Moving a cluster from a DC to another one. Possible scenarios are:
** Keeping current management network.
** Assign default management network (''Management'') to the cluster.
** In both cases: create the mangement network if it doesn't exist in the new DC.

== Installation/Upgrade ==
* During the upgrade the new field (''is_management'') will be added to ''NETWORK_CLUSTER'' table and will be populated by ''true'' value for ovirtmgmt networks and ''false'' for all other networks.
* The following DB objects will be updated with the new field:
** ''NETWORK_CLUSTER_VIEW''
** Stored procedures:
*** ''GetAllNetworkByClusterId''
*** ''Insertnetwork_cluster''
*** ''Updatenetwork_cluster''
* New stored procedure ''set_network_exclusively_as_management'' will be created

[[Category:DetailedFeature]]
