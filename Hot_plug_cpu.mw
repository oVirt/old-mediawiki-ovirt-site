<!-- {{autolang|base=yes}} -->

== Hot plug cpu==

=== Summary ===
This feature will allow to hot plug cpus to a running VM from ovirt engine UI and REST api. 

=== Owner ===
* Name: [[User:MyUser| Roy Golan]]
* Email: rgolan@redhat.com

=== Current status ===
* 1st draft of wiki and VDSM code
* Last updated: {{CURRENTMONTHNAME}} {{CURRENTDAY}}, {{CURRENTYEAR}}<!--This is markup for current date, do not change-->

=== Detailed Description ===
Historically, CPU and memory hot add and remove capabilities were thought of as server hardware RAS features. However, the concepts of CPU and memory hot add and remove are both common and necessary for Virtualized environments. Virtual CPUs and virtual memory assigned to a virtual machine (VM) need to be be added or removed from a running guest in order to meet either the workload's demands or to maintain the SLA associated with the workload. It is also desired for the rapid reconfiguration of a guest once a workload has been completed or migrated and an administrator wants to reconfigure the VM without having to re-boot the VM.

=== Benefit to oVirt ===
this feature will enable this powerful use cases:
* allow admins the ability to ensure customer's SLA are being met
* allow utilizing spare hardware - its common to see systems overdimentioned x3 for an average max load
* allow dynamically to scale vertically, down or up, a system hardware according to needs *without restarting* the VM 

=== changes ===
{| class="wikitable sortable"
|-
!Component !! requirement !! completed
|-
| Engine || add a new Vds command setNumberOfCpus VmId: Guid, numberOfCpus: int || 0
|-
| Engine || UpdateVmCommand permits number of cpus change while VM is running  || 0
|-
| Engine || UpdateVmCommand canDo fail if # of cpus is not supported on host (config value?, get the actual number from caps?) || 0
|-
| Engine || UpdateVmCommand send setNumberOfCpus verb when cpus changes || 0
|-
| Engine || UpdateVmCommand stores the new number of CPUs only if the call to setNumberOfCpus succeeded AND in a different db call || 0
|-
| Engine || create informative Audit log when setNumberOfCpus fails || 0
|-
| VDSM || create one new verb 'setNumberOfCpus'.  it would be used for both plug/unplug cpus (its really "online" a cpu rather than hotplug) || patch ready
|-
| VDSM || in vm.py, bind the verb to an underling call to libvirt's setVcpus || patch ready
|-
| VDSM || hook support - is it needed for this feature?  || 0
|- 
| VDSM || check migration of a VM that was hotplugged with cpus and remigrate it (not sure changes needed) || 0
|}

=== Dependencies / Related Features ===
KVM support for hot plug 
libvirt support for hotattach device

=== Documentation / External references ===
OS support matrix for hot add/remove CPU - TODO

=== Testing ===
TODO

=== Comments and Discussion ===
* Refer to [[Talk:Hot plug cpu]]  <!-- This adds a link to the "discussion" tab associated with your page.  This provides the ability to have ongoing comments or conversation without bogging down the main feature page -->

[[Category:Feature]]
[[Category:Template]]
