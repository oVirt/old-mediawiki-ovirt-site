<!-- {{autolang|base=yes}} -->

<!-- The actual name of your feature page should look something like: "Your feature name". Use natural language to name the pages. -->

== iSCSI MultiPath ==

{{Feature|name=iSCSI Multipath|modules=storage|version=3.4|status=Released}}

=== Motivation ===
oVirt support connection between Hosts and iSCSI Storage Domains.<BR/> 
The connection between the Host and the iSCSI Storage Domain is being done using a bridge which used by a NIC, and gets connected to the Storage domain using that NIC.<BR/>
At some cases, we will  want to configure a Host with multiple NICs, which some of them will be used to connect to relevant Storage Domains, and others for other issues.<BR/>
We will also might want to use the DM-multipath, for getting stable and reliable connection to the Storage Domain.<BR/>
Today, we can not configure this ability from oVirt, since the Host connects to the Storage Domain with a default NIC configured in the Host.<BR/>
iSCSI MultiPath Bond is an entity which tends to overcome this difficulty.<BR/>
With iSCSI MultiPath Bond the user can combine networks which will be used to connect to the iSCSI Storage Domain using the Hosts in the Data Center.

=== Summary ===

iSCSI multipath feature enables the user to configure the iSCSI multipath from oVirt, by specifying the networks to be used by the the iSCSI multipath Bond</BR>
The user can configure the Hosts to connect to the iSCSi  server through this specific networks.

===  A brief about multipath linux  ===
[[Feature/iSCSI-Multipath#Device-Mapper|Device-Mapper]] Multipath (DM-Multipath) is a Linux native multipath tool, which allows to [[Feature/iSCSI-Multipath#Configuration of Multipath|configure]] multiple I/O paths between server nodes and storage arrays into a single device.<BR/>
Each multipath device has a World Wide Identifier (WWID), which is guaranteed to be globally unique and unchanging. By default, the name of a multipath device is set to its WWID<BR/><BR/>

===== Configuration of Multipath =====
The configuration of the multipath service  is being done on each host and it is the user responsibility to configure it at multipath.conf<BR/>
Some of the attributes being configured among many others are 
* path_selector algorithm which determines which path  to use for every I/O operation to the storage (round-robin, queue length, service time)
* path_grouping_policy  - failover, multibus, group by
* checker_timeout  - The timeout to use for path checkers that issue SCSI commands with an explicit timeout, in seconds. The default value is taken from sys/block/sdx/device/timeout


===== Device-Mapper =====
The Device-Mapper is a Linux kernel framework which used for mapping block devices onto higher-level virtual block devices.
In the Linux kernel, the device-mapper is a generic framework to map one block device into another.
Device mapper works by passing data from a virtual block device (provided by the device mapper itself) to another block device.

=== Owner ===

* Name: 
* Email: 

=== Current status ===

* Merged to 3.4 branch

=== Detailed Description ===
The iSCSI multipath Bond is an entity managed under the Data Center.<BR/>
Once the Data Center has iSCSI storage attached to it, the user can configure an iSCSI bond with an appropriate networks.<BR/>
The User choose which networks the iSCSI multipath Bond will be assembled from.<BR/>
The iSCSI bond can be empty, with no networks configured in it, or it can be configured with one or more networks related to the Data Center.<BR/>
<BR/>
Once the iSCSI multipath is configured with networks all the Hosts in the Data Center will connect to the iSCSI Storage Domain through this iSCSI bond the user configured.<BR/>
The path selection for the connection to the iSCSI storage will be configured by the multipath.conf in each host.<BR/><BR/>

=== Permissions ===
Every user with permissions on the Data Center, can add/change or remove iSCSI Bond.

=== iSCSI Bond behaviour ===
* Each Data Center with iSCSI storage can have one or more iSCSI Bonds. The iSCSI bond is not obligated in gthe Data Center.
* Each iSCSI bond can be configured with any of the  networks configured in the Data Center. There is no obligation regarding the number of the networks configured in the iSCSI Bond.
* iSCSI Bond name should be a unique name in the Data Center.
* Once a network is being removed from a Data Center it should be automatically removed from the iSCSI Bond as well.
* Once a Data Center is being removed all the iSCSI Bonds related to it should be removed as well.
* Once a network is being added to the iSCSI Bond, all the Hosts connected to the iSCSI storage which contains the added network should connect to the storage with the new network as well.
* Once a Host gets activate in the iSCSI Data Center it should connect to the iSCSI storage with all the networks available in the iSCSI Bond<BR/>
* If the Host does not contain any of the networks configured in the iSCSI bond it should connect to the storage iSCSI with its default network<BR/>
* If the Host does contain the networks configured in the iSCSI bond and it does not succeed to connect to the iSCSI storage with them then the Host should become non operational.

=== User Experience ===
For the user to start using the iSCSI bond, it will need to do the following:

# Add an iSCSI Storage to the Data Center
#  Make sure the Data Center contains networks.
#  Go to the Data Center main tab and choose the specific Data Center
#  At the sub tab choose "iSCSI Bond"
#  Press the "new" button to add a new iSCSI Bond
#  Configure the networks you want to add to the new iSCSI Bond.

Once a new iSCSI bond is configured, The Hosts in the Data Center connects to the iSCSI storage using the networks configured in the bond.

=== Comments and Discussion ===

* Refer to [[Talk: iSCSIMultiPath ]] 

[[Category:Feature]]
[[Category:Template]]
