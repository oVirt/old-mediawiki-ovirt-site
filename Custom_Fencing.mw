Here are detailed instructions how to add a custom agent:

=== Pre oVirt 3.5 releases ===

a) Add your new agent to VdsFenceType option_value in vdc_options table for the relevant cluster version<br>
b) Add agent options mappings to VdsFenceOptionMapping option_value in vdc_options table for the relevant cluster version<br>
c) If the agent maps actually to another agent , add that to FenceAgentMapping option_value in vdc_options<br>

Example :
   Adding zzz agent support for version 3.3 that maps internally to ipmi and have just port setting (from: port, slot, secure) that maps to the fencing script ipport
   a) VdsFenceType for 3.3 becomes "apc,apc_snmp,bladecenter,cisco_ucs,drac5,eps,ilo,ilo2,ilo3,ilo4,ipmilan,rsa,rsb,wti,zzz"<br>
   b) VdsFenceOptionMapping for 3.3 becomes "apc:secure=secure,port=ipport,slot=port;apc_snmp:port=port;bladecenter:secure=secure,port=ipport,slot=port;cisco_ucs:secure=ssl,slot=port; drac5:secure=secure,slot=port;eps:slot=port;ilo:secure=ssl,port=ipport;ipmilan:;ilo2:secure=ssl,port=ipport;ilo3:;ilo4:;rsa:secure=secure,port=ipport;rsb:;wti:secure=secure,port=ipport,slot=port;zzz:port=ipport"<br>
   c) FenceAgentMapping becomes "ilo2=ilo,ilo3=ipmilan,ilo4=ipmilan,zzz=ipmilan"<br>

NOTES

1) Please backup your database <br>
2) You should restart the engine for this to take place<br>
3) Custom definitions will be overridden in your next upgrade , for the long run please fill RFE so it will be part of the supported agents <br>

=== oVirt 3.5 ===
In oVirt 3.5 we had added custom fence configuration keys :

 CustomFenceAgentMapping - Maps a fencing agent to other agent implicitly. 
    Format : ((\\w)+[=](\\w)+[,]{0,1})+. 
    Example: agent1=agent2,agent3=agent4
 CustomFenceAgentDefaultParams - Default parameters per agent. 
    Format ([\\w]+([=][\\w]+){0,1}[,]{0,1})+. 
    Example: agent1=key1=val1,flag;key2=val2
 CustomVdsFenceOptionMapping - secure/port/slot mapping support per agent. 
    Format ([\\w]+[:]([\\w]*[=][\\w]*[,]{0,1}[;]{0,1}){0,3}[;]{0,1})+. 
    Example: agent1:secure=secure;agent2:port=ipport,slot=slot
 CustomVdsFenceType - Fence agents types. 
    Format ((\\w)+[,]{0,1})+. 
    Example: agent1,agent2
 CustomFencePowerWaitParam - Maps a fencing agent to the param for delay on/off actions. 
    Format : ((\\w)+[=](\\w)+[,]{0,1})+. 
    Example: agent1=power_wait,agent2=delay

Those keys are accessible from the engine-config util

Example :
Adding zzz agent support for version 3.5 that maps internally to ipmi and have just port setting (from: port, slot, secure) that maps to the fencing script ipport

   engine-config -s CustomVdsFenceType="zzz"
   engine-config -s CustomFenceAgentMapping="zzz=ipmilan"
   engine-config -s CustomVdsFenceOptionMapping="zzz:port=ipport"
   engine-config -s CustomFencePowerWaitParam="zzz=power_wait"


In this case those changes remains valid after oVirt upgrades as well, so please use that method from oVirt 3.5 and on.
