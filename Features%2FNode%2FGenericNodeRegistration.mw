== Generic Node Registration<!-- The name of your feature --> ==

=== Summary ===
<!-- A sentence or two summarizing what this feature is and what it will do.  This information is used for the overall feature summary page for each release. -->
This will provide a generic, extensible way for Node to register to management servers.


=== Owner ===
<!--This should link to your home wiki page so we know who you are-->
* Name: [[User:rbarry| Ryan Barry]]

<!-- Include your email address that you can be reached should people want to contact you about helping with your feature, status is requested, or  technical issues need to be resolved-->
* Email: rbarry AT redhat DOT com
* IRC:  rbarry


=== Current status ===
* Development 0% complete
* Link to feature page in a specific release. That release may complete the feature, or parts of it. The complete scope of this feature in this release will be described in the release feature page
* Last updated: {{CURRENTMONTHNAME}} {{CURRENTDAY}}, {{CURRENTYEAR}}<!--This is markup for current date, do not change-->

=== Detailed Description ===
<!-- Expand on the summary, if appropriate.  A couple sentences suffices to explain the goal, but the more details you can provide the better. -->
The current registration process for oVirt Node relies upon vdsm-reg, which relies on configuration-as-code and is not suitable for other managers. Generic registration will provide a registration process which relies on structured data (YAML or JSON) to describe steps and parameters for execution.

=== Benefit to oVirt ===
<!-- What is the benefit to the oVirt project?  If this is a major capability update, what has changed?  If this is a new feature, what capabilities does it bring? Why will oVirt become a better distribution or project because of this feature?-->
Increased agility, easier integration into other projects.

=== Dependencies / Related Features ===
<!-- What other packages depend on this package?  Are there changes outside the developers' control on which completion of this feature depends?  In other words, completion of another feature owned by someone else and might cause you to not be able to finish on time or that you would need to coordinate? Other Features that might get affected by this feature? -->

* Affected Packages
** ovirt-node

=== Documentation / External references ===
<!-- Is there upstream documentation on this feature, or notes you have written yourself?  Link to that material here so other interested developers can get involved. Links to RFEs. -->
The code for vdsm-reg and the [http://gerrit.ovirt.org/#/c/20815/ new Engine registration interface] describe the other end of the process.

Draft spec is:
<pre>register:
  get_ca:
    action: get
    url: "http://{host}/url?cmd=get-ca-roots"
    parameters: [host]
    filename: /etc/pki/ovirt-engine.key
  approve:
    action: ui
    key: OVIRT_ENGINE_FINGERPRINT
  persist_ca:
    action: persist
    file: /etc/pki/ovirt-engine.key
  get_ssh:
    action: get
    url: "http://{host}/url?=cmd=get-sshkey&type=manager"
    parameters: [host]
    filename: /tmp/ovirt-engine.key
  authorize:
    action: exec
    cmd: "cat /tmp/ovirt-engine.key >> /home/admin/.ssh/.authorized_keys"
  persist_ssh:
    action: persist
    file: /home/admin/.ssh/.authorized_keys
  finish:
    action: get
    url: "http://{host}/url?cmd=register&name={name}&ip={ip}&sshkeyfingerprint={fingerprint}&user={user}"
    parameters: [host, name, ip, fingerprint, user]
</pre>

=== Comments and Discussion ===

This below adds a link to the "discussion" tab associated with your page.  This provides the ability to have ongoing comments or conversation without bogging down the main feature page

* Refer to [[Talk:Generic Node Registration]]  <!-- This adds a link to the "discussion" tab associated with your page.  This provides the ability to have ongoing comments or conversation without bogging down the main feature page -->

[[Category:Feature]]
[[Category:Template]]
[[Category:Node]]
